{"version":3,"sources":["webpack://qjmind/webpack/universalModuleDefinition","webpack://qjmind/./node_modules/@babel/runtime/helpers/esm/typeof.js","webpack://qjmind/./src/mind.js","webpack://qjmind/webpack/bootstrap","webpack://qjmind/webpack/runtime/define property getters","webpack://qjmind/webpack/runtime/hasOwnProperty shorthand","webpack://qjmind/webpack/runtime/make namespace object","webpack://qjmind/./index.js"],"names":["_typeof","obj","Symbol","iterator","constructor","prototype","isValueNull","val","undefined","qjm","opts","fn","canvasContainer","canvas","ctx","ratio","scale","canvasCenterPos","allNodePosMap","mind","init","render","data","nodeJson","create_mind","add_event","document","querySelector","container","createElement","appendChild","getContext","w","offsetWidth","h","offsetHeight","width","height","style","devicePixelRatio","window","backingStoreRatio","webkitBackingStorePixelRatio","mozBackingStorePixelRatio","msBackingStorePixelRatio","oBackingStorePixelRatio","backingStorePixelRatio","getCanvasCenterPos","translate","x","y","Mind","clearCanvas","cT","getTransform","matrix","a","b","c","d","e","f","lt","_getXY","rb","clearRect","changeLayout","add_event_zoom","add_event_dragmove","add_event_click","addEventListener","event","ctrlKey","metaKey","preventDefault","passive","zoom","stopPropagation","deltaY","offsetX","offsetY","requestAnimationFrame","show_view","t","isDown","_mousemove","clientX","clientY","_mouseup","cursor","removeEventListener","newxy","ex","ey","all_nodes","i","length","p","keyNodeClick","type","Math","pow","expandedLeft","expandedRight","expanded","children","hubNodeClick","mouseX","mouseY","newX","newY","util","throttle","wait","timer","setTimeout","apply","arguments","clearTimeout","newid","Date","getTime","toString","random","substr","deepClone","objClone","Array","isArray","Object","key","hasOwnProperty","flatArray","arr","concat","arr1","forEach","item","push","KeyNode","objectiveId","text","shape","keyNodeWidth","keyNodeHeight","hubRadius","lineColor","childIndex","rankIndex","direction","isRoot","parent","childrenCountLeft","childrenCountRight","hubPosLeft","hubPosRight","hubPos","childrenCount","show","getHubPos","drawKeyNode","drawContent","set_mind_pos_map","nodePos","map","save","beginPath","fillStyle","shadowBlur","shadowColor","fillRect","fill","restore","_drawText","str","fontsize","lineHeight","textAlign","currSumWidth","lineNum","fillText","measureText","_drawCircle","left","top","r","centerText","bgcolor","arc","PI","closePath","_drawRect","x0","y0","shapeobj","background","textobj","font","color","textBaseline","value","drawLine_to_child","moveTo","strokeStyle","lineTo","stroke","drawHub","drawLine_to_parent","moveToX","moveToY","quadraticCurveTo","pos","_drawHub","childLength","get_children_nodes","dir","filter","canvasCenter","nodes","nodesFlatArray","totalHeight","totalMaxNodeLength","get_nodes","get_expanded_node_group","get_group_max_length","layout","_parse","parentNode","parentNodeJson","node","add_node","index","childNodeJson","child_node","id","_draw_nodes","_draw_lines","group","groupInfo","group_index","expandedRankMaxLeft","expandedRankMaxRight","expandedNodesLeft","expandedNodesRight","_rank","rankid","children_l","children_r","j","isEmpty","slice","nodeLengthLeft","nodeLengthRight","maxNodeLength","max","maxSideDirection","_get_total_height","bottom","top_y","centerPos","rank_max_nodes_length_l","rank_max_nodes_length_r","_layout_backward","_layout_forward","expandedNodes","groupCenterPos","expandedRankMax","rankMaxNodes","rankMaxNodesTotalHeight","top_h","currRankNodes","nextRankNodes","currRankNodesFlat","y1","diff","QjMind"],"mappings":"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","file":"main.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"qjmind\"] = factory();\n\telse\n\t\troot[\"qjmind\"] = factory();\n})(self, function() {\nreturn ","export default function _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {\n    _typeof = function _typeof(obj) {\n      return typeof obj;\n    };\n  } else {\n    _typeof = function _typeof(obj) {\n      return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n    };\n  }\n\n  return _typeof(obj);\n}","const isValueNull = function (val) {\n  return val === \"\" || val === null || val === undefined;\n};\n\nvar qjm = function (opts, fn) {\n  this.opts = opts;\n  this.fn = fn;\n  this.canvasContainer = null;\n  this.canvas = null;\n  this.ctx = null;\n  this.ratio = null;\n  this.scale = 0.8;\n  this.canvasCenterPos = {};\n  this.allNodePosMap = {};\n  this.mind = null;\n\n  this.init();\n};\nqjm.prototype = {\n  render(data) {\n    this.nodeJson = data;\n    this.create_mind();\n    this.add_event();\n  },\n  init() {\n    this.canvasContainer = document.querySelector(this.opts.container);\n    this.canvas = document.createElement(\"canvas\");\n    this.canvasContainer.appendChild(this.canvas);\n    this.ctx = this.canvas.getContext(\"2d\");\n\n    var w = this.canvasContainer.offsetWidth;\n    var h = this.canvasContainer.offsetHeight;\n    this.canvas.width = w;\n    this.canvas.height = h;\n    this.canvas.style.width = w + \"px\";\n    this.canvas.style.height = h + \"px\";\n\n    // 屏幕的设备像素比\n    var devicePixelRatio = window.devicePixelRatio || 1;\n    // 浏览器在渲染canvas之前存储画布信息的像素比\n    var backingStoreRatio =\n      this.ctx.webkitBackingStorePixelRatio ||\n      this.ctx.mozBackingStorePixelRatio ||\n      this.ctx.msBackingStorePixelRatio ||\n      this.ctx.oBackingStorePixelRatio ||\n      this.ctx.backingStorePixelRatio ||\n      1;\n    // canvas的实际渲染倍率\n    this.ratio = devicePixelRatio / backingStoreRatio;\n    this.canvas.width *= this.ratio;\n    this.canvas.height *= this.ratio;\n    this.canvasCenterPos = this.getCanvasCenterPos();\n    this.ctx.scale(this.ratio, this.ratio);\n    // 初始化缩放\n    this.ctx.translate(this.canvasCenterPos.x, this.canvasCenterPos.y);\n    this.ctx.scale(this.scale, this.scale);\n    this.ctx.translate(-this.canvasCenterPos.x, -this.canvasCenterPos.y);\n  },\n  create_mind() {\n    this.mind = new qjm.Mind(this, this.opts, this.nodeJson);\n  },\n  clearCanvas() {\n    // 矩阵换算鼠标点击位置对应的新坐标\n    var cT = this.ctx.getTransform();\n    let matrix = [cT.a, cT.b, cT.c, cT.d, cT.e, cT.f];\n    var lt = this._getXY(matrix, 0, 0);\n    var rb = this._getXY(\n      matrix,\n      this.canvasContainer.offsetWidth,\n      this.canvasContainer.offsetHeight\n    );\n    this.ctx.clearRect(lt.x, lt.y, rb.x - lt.x, rb.y - lt.y);\n  },\n  changeLayout() {\n    this.clearCanvas();\n    this.mind.init();\n  },\n  // 计算画布中心\n  getCanvasCenterPos() {\n    return {\n      x: this.canvas.width / this.ratio / 2,\n      y: this.canvas.height / this.ratio / 2,\n    };\n  },\n  add_event() {\n    this.add_event_zoom();\n    this.add_event_dragmove();\n    this.add_event_click();\n  },\n  add_event_zoom() {\n    // 禁用原生页面缩放\n    window.addEventListener(\n      \"mousewheel\",\n      function (event) {\n        if (event.ctrlKey === true || event.metaKey) {\n          event.preventDefault();\n        }\n      },\n      { passive: false }\n    );\n    //firefox\n    window.addEventListener(\n      \"DOMMouseScroll\",\n      function (event) {\n        if (event.ctrlKey === true || event.metaKey) {\n          event.preventDefault();\n        }\n      },\n      { passive: false }\n    );\n    // canvas缩放\n    this.canvas.addEventListener(\"wheel\", (e) => {\n      let zoom = 1;\n      e.stopPropagation();\n      e.preventDefault();\n      if (e.ctrlKey) {\n        if (e.deltaY > 0) zoom = 0.95;\n        if (e.deltaY < 0) zoom = 1.05;\n        if (this.scale * zoom > 1.1 || this.scale * zoom < 0.5) return;\n        this.scale *= zoom;\n\n        this.clearCanvas();\n        this.ctx.translate(e.offsetX, e.offsetY);\n        this.ctx.scale(zoom, zoom);\n        this.ctx.translate(-e.offsetX, -e.offsetY);\n\n        requestAnimationFrame(() => {\n          this.mind.show_view();\n        });\n      }\n    });\n  },\n  add_event_dragmove() {\n    var t = this;\n    var canvas = this.canvas;\n    var isDown = false;\n    var x, y;\n    function _mousemove(e) {\n      if (!isDown) return;\n      t.clearCanvas();\n      t.ctx.translate((e.clientX - x) / t.scale, (e.clientY - y) / t.scale);\n      requestAnimationFrame(() => {\n        t.mind.show_view();\n      });\n      x = e.clientX;\n      y = e.clientY;\n      return false;\n    }\n    function _mouseup(e) {\n      //开关关闭\n      canvas.style.cursor = \"default\";\n      canvas.removeEventListener(\"mousemove\", _mousemove);\n      canvas.removeEventListener(\"mouseup\", _mouseup);\n      isDown = false;\n    }\n    canvas.addEventListener(\"mousedown\", (e) => {\n      //获取x坐标和y坐标\n      x = e.clientX;\n      y = e.clientY;\n      //开关打开\n      isDown = true;\n      canvas.style.cursor = \"grabbing\";\n      canvas.addEventListener(\"mousemove\", _mousemove);\n      canvas.addEventListener(\"mouseup\", _mouseup);\n      return false;\n    });\n  },\n  add_event_click() {\n    var canvas = this.canvas;\n    var ctx = this.ctx;\n    canvas.addEventListener(\"click\", (e) => {\n      // 矩阵换算鼠标点击位置对应的新坐标\n      var cT = ctx.getTransform();\n      let matrix = [cT.a, cT.b, cT.c, cT.d, cT.e, cT.f];\n      var newxy = this._getXY(matrix, e.offsetX, e.offsetY);\n      var ex = newxy.x;\n      var ey = newxy.y;\n\n      var all_nodes = this.allNodePosMap;\n      // 点击内容节点\n      for (var i = 0; i < all_nodes[\"keynode\"].length; i++) {\n        let p = all_nodes[\"keynode\"][i];\n        if (\n          p.x - p.width / 2 <= ex &&\n          ex <= p.x + p.width / 2 &&\n          p.y - p.height / 2 <= ey &&\n          ey <= p.y + p.height / 2\n        ) {\n          // console.log(\"点击了keynode:\" + p.content, p.x, p.y);\n          this.fn.keyNodeClick && this.fn.keyNodeClick(p);\n          return;\n        }\n      }\n      // 点击分支桥接节点\n      for (var type in all_nodes) {\n        if (type == \"keynode\") continue;\n        for (var i = 0; i < all_nodes[type].length; i++) {\n          let p = all_nodes[type][i];\n          if (\n            Math.pow(ex - p[type][0], 2) + Math.pow(ey - p[type][1], 2) <\n            100\n          ) {\n            // console.log(`点击了${p.content}的hub节点${type}`);\n            if (type == \"hubPosLeft\") p.expandedLeft = !p.expandedLeft;\n            if (type == \"hubPosRight\") p.expandedRight = !p.expandedRight;\n            if (type == \"hubPos\") p.expanded = !p.expanded;\n            if (!p.children || !p.children.length) {\n              this.fn.hubNodeClick && this.fn.hubNodeClick(p);\n            } else {\n              this.changeLayout();\n            }\n            return;\n          }\n        }\n      }\n    });\n  },\n  // 矩阵换算\n  _getXY(matrix, mouseX, mouseY) {\n    var newX = (mouseX * this.ratio - matrix[4]) / matrix[0];\n    var newY = (mouseY * this.ratio - matrix[5]) / matrix[3];\n    return { x: newX, y: newY };\n  },\n};\n\nqjm.util = {\n  throttle(fn, wait) {\n    let timer;\n    return function () {\n      if (!timer) {\n        timer = setTimeout(() => {\n          fn.apply(this, arguments);\n          clearTimeout(timer);\n          timer = null;\n        }, wait);\n      }\n    };\n  },\n  newid() {\n    return (\n      new Date().getTime().toString(16) + Math.random().toString(16).substr(2)\n    ).substr(2, 16);\n  },\n  deepClone(obj) {\n    let objClone = Array.isArray(obj) ? [] : obj instanceof Object ? {} : obj;\n    if (obj && obj instanceof Array) {\n      for (let i = 0; i < obj.length; i++) {\n        if (obj[i]) {\n          objClone[i] = qjm.util.deepClone(obj[i]);\n        }\n      }\n    } else if (obj && obj instanceof Object) {\n      for (let key in obj) {\n        if (obj.hasOwnProperty(key)) {\n          if (obj[key] && typeof obj[key] === \"object\") {\n            objClone[key] = qjm.util.deepClone(obj[key]);\n          } else {\n            objClone[key] = obj[key];\n          }\n        }\n      }\n    }\n    return objClone;\n  },\n  flatArray(arr) {\n    arr = [].concat(arr);\n    let arr1 = [];\n    arr.forEach((item) => {\n      if (item instanceof Array) {\n        arr1 = arr1.concat(qjm.util.flatArray(item));\n      } else {\n        arr1.push(item);\n      }\n    });\n    return arr1;\n  },\n};\n\n// 节点构造函数\nqjm.KeyNode = function (qjm, nodeJson) {\n  this.qjm = qjm;\n  this.objectiveId = nodeJson.objectiveId || 0;\n  this.text = nodeJson.text;\n  this.shape = nodeJson.shape;\n  this.x = nodeJson.x;\n  this.y = nodeJson.y;\n  this.width = qjm.opts.keyNodeWidth || 320;\n  this.height = qjm.opts.keyNodeHeight || 100;\n  this.hubRadius = qjm.opts.hubRadius || 10;\n  this.lineColor = qjm.opts.lineColor || \"#e3e4e5\";\n\n  this.childIndex = nodeJson.childIndex;\n  this.rankIndex = nodeJson.rankIndex;\n  this.direction = nodeJson.direction;\n  this.isRoot = nodeJson.isRoot;\n  this.parent = null;\n  this.children = nodeJson.children;\n\n  if (this.isRoot) {\n    this.expandedLeft = nodeJson.expandedLeft;\n    this.expandedRight = nodeJson.expandedRight;\n    this.childrenCountLeft = nodeJson.childrenCountLeft;\n    this.childrenCountRight = nodeJson.childrenCountRight;\n    this.hubPosLeft = null;\n    this.hubPosRight = null;\n  } else {\n    this.hubPos = null;\n    this.expanded = nodeJson.expanded;\n    this.childrenCount = nodeJson.childrenCount;\n  }\n};\nqjm.KeyNode.prototype = {\n  show() {\n    this.getHubPos();\n    this.drawKeyNode();\n    this.drawContent();\n  },\n  set_mind_pos_map(type, nodePos) {\n    var map = this.qjm.allNodePosMap;\n    if (!map[type]) map[type] = [];\n    map[type].push(nodePos);\n  },\n  drawKeyNode() {\n    var ctx = this.qjm.ctx;\n    if (isValueNull(this.x) || isValueNull(this.y)) {\n      return;\n    }\n    ctx.save();\n    ctx.beginPath();\n    ctx.fillStyle = \"#ffffff\";\n    ctx.shadowBlur = 10;\n    ctx.shadowColor = \"rgba(31,35,41,0.08)\";\n\n    ctx.fillRect(\n      this.x - this.width / 2,\n      this.y - this.height / 2,\n      this.width,\n      this.height\n    );\n    ctx.fill();\n    ctx.restore();\n\n    this.set_mind_pos_map(\"keynode\", this);\n  },\n  _drawText(str, x, y, w, h, fontsize, lineHeight, textAlign) {\n    var ctx = this.qjm.ctx;\n    ctx.textAlign = textAlign || \"left\";\n    var currSumWidth = 0;\n    var lineNum = 1;\n    for (let i = 0; i < str.length; i++) {\n      ctx.fillText(str[i], x + currSumWidth, y);\n      currSumWidth += ctx.measureText(str[i]).width;\n      if (i === str.length - 1) return;\n      if (currSumWidth + ctx.measureText(str[i + 1]).width > w) {\n        if (lineHeight * (lineNum + 1) > h) {\n          ctx.fillText(\"...\", x + currSumWidth, y);\n          return;\n        }\n        y += lineHeight;\n        lineNum += 1;\n        currSumWidth = 0;\n      }\n    }\n  },\n  _drawCircle(left, top, r, centerText, bgcolor) {\n    var ctx = this.qjm.ctx;\n    ctx.save();\n    ctx.beginPath();\n    ctx.arc(left, top, r, 0, Math.PI * 2, false);\n    ctx.closePath();\n    ctx.fillStyle = bgcolor;\n    ctx.fill();\n    ctx.restore();\n  },\n  _drawRect(left, top, w, h, bgcolor) {\n    var ctx = this.qjm.ctx;\n    ctx.save();\n    ctx.fillStyle = bgcolor;\n    ctx.fillRect(left, top, w, h);\n    ctx.restore();\n  },\n  drawContent() {\n    var ctx = this.qjm.ctx;\n    var x0 = this.x - this.width / 2;\n    var y0 = this.y - this.height / 2;\n    // 画头像\n    for (var i = 0; i < this.shape.length; i++) {\n      var shapeobj = this.shape[i];\n      if (shapeobj.type == \"circle\") {\n        this._drawCircle(\n          x0 + shapeobj.left,\n          y0 + shapeobj.top,\n          shapeobj.r,\n          shapeobj.text,\n          shapeobj.background\n        );\n      } else {\n        this._drawRect(\n          x0 + shapeobj.left,\n          y0 + shapeobj.top,\n          shapeobj.width,\n          shapeobj.height,\n          shapeobj.background\n        );\n      }\n    }\n    // 姓名+部门名\n    for (var i = 0; i < this.text.length; i++) {\n      var textobj = this.text[i];\n      ctx.save();\n      ctx.font = textobj.fontsize + \"px April\";\n      ctx.fillStyle = textobj.color;\n      ctx.textBaseline = \"top\";\n      this._drawText(\n        textobj.value,\n        x0 + textobj.left,\n        y0 + textobj.top,\n        textobj.width,\n        textobj.height,\n        textobj.fontsize,\n        textobj.lineHeight,\n        textobj.textAlign\n      );\n      ctx.restore();\n    }\n  },\n  drawLine_to_child() {\n    var ctx = this.qjm.ctx;\n    ctx.save();\n    if (this.isRoot) {\n      if (this.childrenCountRight) {\n        ctx.beginPath();\n        ctx.moveTo(this.x + (1 * this.width) / 2, this.y);\n        ctx.strokeStyle = this.lineColor;\n        ctx.lineTo(this.hubPosRight[0], this.hubPosRight[1]);\n        ctx.closePath();\n        ctx.stroke();\n        ctx.restore();\n        this.drawHub(this.hubPosRight, this.childrenCountRight);\n      }\n      if (this.childrenCountLeft) {\n        ctx.beginPath();\n        ctx.moveTo(this.x + (-1 * this.width) / 2, this.y);\n        ctx.strokeStyle = this.lineColor;\n        ctx.lineTo(this.hubPosLeft[0], this.hubPosLeft[1]);\n        ctx.closePath();\n        ctx.stroke();\n        this.drawHub(this.hubPosLeft, this.childrenCountLeft);\n      }\n    } else {\n      ctx.beginPath();\n      ctx.moveTo(this.x + (this.direction * this.width) / 2, this.y);\n      ctx.strokeStyle = this.lineColor;\n      ctx.lineTo(this.hubPos[0], this.hubPos[1]);\n      ctx.closePath();\n      ctx.stroke();\n      ctx.restore();\n      this.drawHub(this.hubPos, this.childrenCount);\n    }\n  },\n  drawLine_to_parent() {\n    var ctx = this.qjm.ctx;\n    ctx.save();\n    ctx.beginPath();\n    var moveToX = this.x - (this.direction * this.width) / 2;\n    var moveToY = this.y;\n    ctx.moveTo(moveToX, moveToY);\n    ctx.strokeStyle = this.lineColor;\n    if (this.parent.isRoot) {\n      this.direction === 1 &&\n        ctx.quadraticCurveTo(\n          moveToX - 50,\n          moveToY,\n          this.parent.hubPosRight[0],\n          this.parent.hubPosRight[1]\n        );\n      this.direction === -1 &&\n        ctx.quadraticCurveTo(\n          moveToX + 50,\n          moveToY,\n          this.parent.hubPosLeft[0],\n          this.parent.hubPosLeft[1]\n        );\n    } else {\n      ctx.quadraticCurveTo(\n        this.direction === 1 ? moveToX - 50 : moveToX + 50,\n        moveToY,\n        this.parent.hubPos[0],\n        this.parent.hubPos[1]\n      );\n    }\n    ctx.stroke();\n    ctx.restore();\n  },\n  drawHub(pos) {\n    if (this.isRoot) {\n      if (this.childrenCountRight) {\n        this._drawHub(this.hubPosRight, this.childrenCountRight);\n        this.set_mind_pos_map(\"hubPosRight\", this);\n      }\n      if (this.childrenCountLeft) {\n        this._drawHub(this.hubPosLeft, this.childrenCountLeft);\n        this.set_mind_pos_map(\"hubPosLeft\", this);\n      }\n    } else {\n      if (this.childrenCount) {\n        this._drawHub(this.hubPos, this.childrenCount);\n        this.set_mind_pos_map(\"hubPos\", this);\n      }\n    }\n  },\n  _drawHub(pos, childLength) {\n    var ctx = this.qjm.ctx;\n    ctx.save();\n    ctx.fillStyle = \"#ffffff\";\n    ctx.shadowBlur = 6;\n    ctx.shadowColor = \"rgba(31,35,41,0.08)\";\n    ctx.beginPath();\n    ctx.arc(pos[0], pos[1], this.hubRadius, 0, Math.PI * 2);\n    ctx.closePath();\n    ctx.fill();\n    ctx.restore();\n\n    if (childLength > 0) {\n      ctx.save();\n      ctx.fillStyle = \"#000000\";\n      ctx.font = \"30px\";\n      ctx.textAlign = \"center\";\n      ctx.textBaseline = \"middle\";\n      ctx.fillText(childLength, pos[0], pos[1]);\n      ctx.restore();\n    }\n  },\n  getHubPos() {\n    if (this.isRoot) {\n      this.hubPosLeft = [this.x + -1 * (this.width / 2 + 40), this.y];\n      this.hubPosRight = [this.x + 1 * (this.width / 2 + 40), this.y];\n    } else {\n      this.hubPos = [this.x + this.direction * (this.width / 2 + 40), this.y];\n    }\n  },\n  get_children_nodes(dir) {\n    return this.children.filter((item) => item.direction === dir);\n  },\n};\n\n// 树图构造函数\nqjm.Mind = function (qjm, opts, nodeJson) {\n  this.qjm = qjm;\n  this.opts = opts;\n  this.canvasCenter = null;\n  this.nodeJson = [].concat(nodeJson);\n  this.nodes = [];\n  this.nodesFlatArray = [];\n  this.totalHeight = 0;\n  this.totalMaxNodeLength = 0;\n\n  this.get_nodes();\n  this.init();\n};\nqjm.Mind.prototype = {\n  init() {\n    this.canvasCenter = this.qjm.getCanvasCenterPos();\n    this.get_expanded_node_group();\n    this.get_group_max_length();\n    this.layout(); //给每个节点赋值xy坐标值\n    this.show_view();\n  },\n  get_nodes() {\n    for (var i = 0; i < this.nodeJson.length; i++) {\n      this.nodes.push(this._parse(this.nodeJson[i]));\n    }\n  },\n  _parse(nodeJson, parentNode, parentNodeJson) {\n    nodeJson.x = null;\n    nodeJson.y = null;\n\n    let node = this.add_node(nodeJson);\n    node.parent = parentNode;\n    if (nodeJson.children) {\n      node.children = [];\n      for (let index = 0; index < nodeJson.children.length; index++) {\n        let childNodeJson = nodeJson.children[index];\n        childNodeJson.childIndex = index;\n\n        let child_node = this._parse(childNodeJson, node, nodeJson);\n        node.children.push(child_node);\n      }\n    }\n    return node;\n  },\n\n  add_node(nodeJson) {\n    let node = new qjm.KeyNode(this.qjm, nodeJson);\n    node.id = qjm.util.newid();\n    this.nodesFlatArray.push(node);\n    return node;\n  },\n\n  show_view() {\n    for (var i = 0; i < this.nodes.length; i++) {\n      this._draw_nodes(this.nodes[i]);\n      this._draw_lines(this.nodes[i]);\n      //TODO:每组的间隔\n    }\n  },\n  _draw_nodes(node) {\n    if (node.parent && node.parent.isRoot) {\n      if (node.direction === -1 && !node.parent.expandedLeft) return;\n      if (node.direction === 1 && !node.parent.expandedRight) return;\n    }\n    if (node.parent && !node.parent.isRoot) {\n      if (!node.parent.expanded) return;\n    }\n    node.show();\n    if (node.children) {\n      for (let index = 0; index < node.children.length; index++) {\n        let child_node = node.children[index];\n        this._draw_nodes(child_node);\n      }\n    }\n  },\n  _draw_lines(node) {\n    if (node.parent && node.parent.isRoot) {\n      if (node.direction === -1 && !node.parent.expandedLeft) return;\n      if (node.direction === 1 && !node.parent.expandedRight) return;\n    }\n    if (node.parent && !node.parent.isRoot) {\n      if (!node.parent.expanded) return;\n    }\n    if (node.parent) {\n      node.drawLine_to_parent();\n    }\n    if (\n      (node.isRoot && (node.childrenCountLeft || node.childrenCountRight)) ||\n      (!node.isRoot && node.childrenCount)\n    ) {\n      node.drawLine_to_child();\n      for (let index = 0; index < node.children.length; index++) {\n        let child_node = node.children[index];\n        this._draw_lines(child_node);\n      }\n      node.drawHub();\n    }\n  },\n\n  get_expanded_node_group() {\n    var t = this;\n    var group = [];\n    for (var i = 0; i < t.nodes.length; i++) {\n      var groupInfo = {\n        group_index: i,\n        expandedRankMaxLeft: 0,\n        expandedRankMaxRight: 0,\n        expandedNodesLeft: [],\n        expandedNodesRight: [],\n      };\n      groupInfo.expandedNodesLeft[0] = t.nodes[i];\n      groupInfo.expandedNodesRight[0] = t.nodes[i];\n\n      (function _rank(obj, rankid) {\n        obj.rankIndex = rankid;\n        groupInfo.expandedRankMaxRight =\n          obj.direction === 1 && rankid > groupInfo.expandedRankMaxRight\n            ? rankid\n            : groupInfo.expandedRankMaxRight;\n        groupInfo.expandedRankMaxLeft =\n          obj.direction === -1 && rankid > groupInfo.expandedRankMaxLeft\n            ? rankid\n            : groupInfo.expandedRankMaxLeft;\n\n        // 有展开的子元素，则给下一级push进去他的所有子元素数组\n        if (!groupInfo.expandedNodesLeft[rankid + 1])\n          groupInfo.expandedNodesLeft[rankid + 1] = [];\n        if (!groupInfo.expandedNodesRight[rankid + 1])\n          groupInfo.expandedNodesRight[rankid + 1] = [];\n\n        if (\n          obj.children &&\n          obj.children.length &&\n          (obj.expanded || obj.expandedLeft || obj.expandedRight)\n        ) {\n          var children_l = [],\n            children_r = [];\n          obj.children.forEach((item) => {\n            if (item.direction === -1) children_l.push(item);\n            if (item.direction === 1) children_r.push(item);\n          });\n          children_l.length &&\n            groupInfo.expandedNodesLeft[rankid + 1].push(children_l);\n          children_r.length &&\n            groupInfo.expandedNodesRight[rankid + 1].push(children_r);\n\n          for (var j = 0; j < obj.children.length; j++) {\n            _rank(obj.children[j], rankid + 1);\n          }\n        } else {\n          // 没有展开的子元素，则给下一级加一个空元素 用来占位\n          if (obj.isRoot || (!obj.isRoot && obj.direction === -1))\n            groupInfo.expandedNodesLeft[rankid + 1].push({\n              isEmpty: true,\n              rankIndex: rankid + 1,\n            });\n          if (obj.isRoot || (!obj.isRoot && obj.direction === 1))\n            groupInfo.expandedNodesRight[rankid + 1].push({\n              isEmpty: true,\n              rankIndex: rankid + 1,\n            });\n        }\n      })(t.nodes[i], 0);\n\n      groupInfo.expandedNodesLeft = groupInfo.expandedNodesLeft.slice(\n        0,\n        groupInfo.expandedRankMaxLeft + 1\n      );\n      groupInfo.expandedNodesRight = groupInfo.expandedNodesRight.slice(\n        0,\n        groupInfo.expandedRankMaxRight + 1\n      );\n\n      t.nodes[i].groupInfo = groupInfo;\n    }\n  },\n  // 组的最大末级节点数\n  get_group_max_length() {\n    var t = this;\n    for (var i = 0; i < t.nodes.length; i++) {\n      var groupInfo = t.nodes[i].groupInfo;\n      // 对比左右两边的末级节点的高度，将最大值赋值给节点组高度\n      var nodeLengthLeft = qjm.util.flatArray(\n        groupInfo.expandedNodesLeft[groupInfo.expandedNodesLeft.length - 1]\n      ).length;\n      var nodeLengthRight = qjm.util.flatArray(\n        groupInfo.expandedNodesRight[groupInfo.expandedNodesRight.length - 1]\n      ).length;\n\n      groupInfo.maxNodeLength = Math.max(nodeLengthLeft, nodeLengthRight);\n      groupInfo.totalHeight =\n        groupInfo.maxNodeLength * t.opts.keyNodeHeight + (length - 1) * 20;\n      if (nodeLengthLeft >= nodeLengthRight) {\n        groupInfo.maxSideDirection = -1;\n      } else {\n        groupInfo.maxSideDirection = 1;\n      }\n    }\n  },\n\n  _get_total_height() {\n    var t = this;\n    t.totalHeight = 0;\n    for (var i = 0; i < t.nodes.length; i++) {\n      t.totalMaxNodeLength += t.nodes[i].groupInfo.maxNodeLength;\n      t.totalHeight += t.nodes[i].groupInfo.totalHeight;\n    }\n    var top = t.canvasCenter.y - t.totalHeight / 2;\n    var bottom = t.canvasCenter.y + t.totalHeight / 2;\n    for (var i = 0; i < t.nodes.length; i++) {\n      var groupInfo = t.nodes[i].groupInfo;\n\n      if (i > 0 && t.nodes[i - 1].groupInfo.top_y) {\n        groupInfo.top_y =\n          t.nodes[i - 1].groupInfo.top_y +\n          t.nodes[i - 1].groupInfo.totalHeight +\n          100;\n        groupInfo.centerPos = {\n          x: this.canvasCenter.x,\n          y: groupInfo.top_y + groupInfo.totalHeight / 2,\n        };\n      } else {\n        groupInfo.top_y = top;\n        groupInfo.centerPos = {\n          x: this.canvasCenter.x,\n          y: groupInfo.top_y + groupInfo.totalHeight / 2,\n        };\n      }\n    }\n  },\n  layout() {\n    var t = this;\n    t._get_total_height();\n    for (var i = 0; i < t.nodes.length; i++) {\n      var group = t.nodes[i];\n      var dir = group.groupInfo.maxSideDirection;\n      var expandedNodesLeft = group.groupInfo.expandedNodesLeft;\n      var expandedNodesRight = group.groupInfo.expandedNodesRight;\n      // 比较左右两边的高度，值大则反向布局，值小的正向布局\n      // 左边\n      var rank_max_nodes_length_l = qjm.util.flatArray(\n        expandedNodesLeft[expandedNodesLeft.length - 1]\n      );\n      // 右边\n      var rank_max_nodes_length_r = qjm.util.flatArray(\n        expandedNodesRight[expandedNodesRight.length - 1]\n      );\n      if (rank_max_nodes_length_l > rank_max_nodes_length_r) {\n        t._layout_backward(expandedNodesLeft, -1, group.groupInfo.centerPos);\n        t._layout_forward(expandedNodesRight, 1, group.groupInfo.centerPos);\n      } else {\n        t._layout_backward(expandedNodesRight, 1, group.groupInfo.centerPos);\n        t._layout_forward(expandedNodesLeft, -1, group.groupInfo.centerPos);\n      }\n    }\n  },\n\n  // 反向推定位：从末级节点向根节点推定位\n  _layout_backward(expandedNodes, dir, groupCenterPos) {\n    // 末级\n    var expandedRankMax = expandedNodes.length - 1;\n    var rankMaxNodes = qjm.util.flatArray(expandedNodes[expandedRankMax]);\n    let rankMaxNodesTotalHeight =\n      rankMaxNodes.length * this.opts.keyNodeHeight +\n      (rankMaxNodes.length - 1) * 20;\n\n    let top_h =\n      groupCenterPos.y -\n      rankMaxNodesTotalHeight / 2 +\n      this.opts.keyNodeHeight / 2;\n\n    for (var i = 0; i < rankMaxNodes.length; i++) {\n      rankMaxNodes[i].x =\n        groupCenterPos.x +\n        dir * expandedRankMax * (this.opts.keyNodeWidth + 110);\n      rankMaxNodes[i].y = top_h + i * (this.opts.keyNodeHeight + 20);\n    }\n\n    // 前面级的节点\n    for (var i = expandedNodes.length - 2; i >= 0; i--) {\n      var currRankNodes = expandedNodes[i]; //i为级数\n      var nextRankNodes = expandedNodes[i + 1]; //获取到后面那级的数据\n      var currRankNodesFlat = qjm.util.flatArray(currRankNodes);\n      for (var j = 0; j < currRankNodesFlat.length; j++) {\n        var node = currRankNodesFlat[j];\n        node.x = groupCenterPos.x + dir * i * (this.opts.keyNodeWidth + 110);\n\n        if (nextRankNodes[j] instanceof Object && nextRankNodes[j].isEmpty) {\n          node.y = nextRankNodes[j].y;\n        } else {\n          var children = node.children.filter((item) => item.direction === dir);\n          if (children.length) {\n            node.y = (children[0].y + children[children.length - 1].y) / 2;\n          }\n        }\n      }\n    }\n  },\n  // 正向推定位：从根级节点向末级推定位\n  _layout_forward(expandedNodes, dir, groupCenterPos) {\n    var y0 = expandedNodes[0].y;\n    this._layout_backward(expandedNodes, dir, groupCenterPos);\n    var y1 = expandedNodes[0].y;\n    var diff = y1 - y0;\n    for (var i = 0; i < expandedNodes.length; i++) {\n      var currRankNodes = expandedNodes[i]; //i为级数\n      var currRankNodesFlat = qjm.util.flatArray(currRankNodes);\n      for (var j = 0; j < currRankNodesFlat.length; j++) {\n        var node = currRankNodesFlat[j];\n        if (!node.isEmpty) node.y -= diff;\n      }\n    }\n  },\n};\n\nexport default qjm;\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tif(__webpack_module_cache__[moduleId]) {\n\t\treturn __webpack_module_cache__[moduleId].exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","import QjMind from \"./src/mind\";\n\nexport default QjMind;"],"sourceRoot":""}